# > Clash Verge Rev@laoshu è‡ªç”¨é…ç½®
# > https://raw.githubusercontent.com/jnlaoshu/MySelf/master/Clash/ClashVerge/Profile.yaml
# > Update: 2026.01.18 17:40

# --- åŸºç¡€å‚æ•° ---
mode: rule
ipv6: true              # å¿…é¡»å¼€å¯ï¼Œå¦åˆ™æ— æ³•è¿æ¥ IPv6 ç«™ç‚¹
log-level: info         # info çº§åˆ«è¶³å¤Ÿæ’æŸ¥é—®é¢˜ï¼Œwarning å¯èƒ½æ¼æ‰å…³é”®ä¿¡æ¯
allow-lan: true
mixed-port: 7893        # æ··åˆç«¯å£ï¼ŒVerge Rev ä¼šè‡ªåŠ¨å¤„ç†ç³»ç»Ÿä»£ç†
bind-address: '*'
find-process-mode: strict # strict æ¨¡å¼åœ¨ Windows/Linux ä¸‹å¯¹æ¸¸æˆ/åº”ç”¨åˆ†æµæ›´ç²¾å‡†
global-client-fingerprint: chrome

# --- æ€§èƒ½ä¼˜åŒ– ---
keep-alive-interval: 15
keep-alive-idle: 600
tcp-concurrent: true     # å¼€å¯ TCP å¹¶å‘ï¼ŒåŠ é€Ÿæ¡æ‰‹
unified-delay: true      # å»é™¤æ¡æ‰‹å»¶è¿Ÿï¼Œæµ‹é€Ÿæ›´çœŸå®

# --- å¤–éƒ¨èµ„æº (ä½¿ç”¨ MetaCubeX å®˜æ–¹ CDNï¼Œé€Ÿåº¦æ›´å¿«) ---
profile:
  store-selected: true
  store-fake-ip: true
geo-auto-update: true
geo-update-interval: 24
geodata-mode: true
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"
  asn: "https://github.com/xishang0128/geoip/releases/download/latest/GeoLite2-ASN.mmdb"

# --- å…³é”®ï¼šå—…æ¢å™¨ (Sniffer) ---
# è§£å†³é€æ˜ä»£ç†ä¸‹åŸŸåè¯†åˆ«é—®é¢˜ï¼ŒVerge Rev å¼ºåŠ›æ¨èå¼€å¯
sniffer:
  enable: true
  parse-pure-ip: true
  override-destination: true # æµé‡é‡å®šå‘ï¼Œé˜²æ­¢ DNS åŠ«æŒ
  force-dns-mapping: true    # å¼ºåˆ¶å°†å—…æ¢åˆ°çš„åŸŸåæ˜ å°„å› Fake-IP
  sniff:
    HTTP: { ports: [80, 8080-8880], override-destination: true }
    TLS: { ports: [443, 8443], override-destination: true }
    QUIC: { ports: [443, 8443], override-destination: true }

# --- Tun æ¨¡å¼ (æ— æ„Ÿä»£ç†æ ¸å¿ƒ) ---
tun:
  enable: true
  stack: mixed            # å…¼å®¹æ€§æœ€å¥½ï¼Œè‹¥æœ‰æ–­æµå¯å°è¯• gvisor
  auto-route: true
  auto-redirect: true     # è‡ªåŠ¨é‡å®šå‘æµé‡
  auto-detect-interface: true
  dns-hijack:
    - "any:53"
    - "tcp://any:53"

# --- DNS è®¾ç½® (æ ¸å¿ƒé‡æ„ï¼šåˆ†æµä¸é˜²æ³„æ¼) ---
dns:
  enable: true
  ipv6: true            # å…è®¸ DNS è§£æ IPv6 åœ°å€
  listen: :1053
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  prefer-h3: true       # å¼€å¯ DoH çš„ HTTP/3 æ”¯æŒï¼ŒæŸ¥è¯¢æ›´å¿«
  
  # 1. é»˜è®¤ DNS (è§£æå›½å¤–åŸŸåï¼Œä½¿ç”¨åŠ å¯† DNS)
  nameserver:
    - https://8.8.8.8/dns-query
    - https://1.1.1.1/dns-query
  
  # 2. å¤‡ç”¨ DNS (å›½å¤–)
  fallback:
    - https://dns.google/dns-query
    - https://cloudflare-dns.com/dns-query
  
  # 3. æŒ‡å®šåˆ†æµ (å›½å†…åŸŸåèµ°å›½å†… DNSï¼ŒBYR èµ°å›½å†… DNS)
  nameserver-policy:
    "geosite:cn,private": 
      - https://223.5.5.5/dns-query
      - https://1.12.12.12/dns-query
    # é’ˆå¯¹æ€§ä¿®å¤ï¼šbyr.pt å¿…é¡»ä½¿ç”¨å›½å†…/ç›´è¿ DNS è§£æï¼Œç¡®ä¿æ‹¿åˆ° AAAA è®°å½•
    "byr.pt": 
      - https://223.5.5.5/dns-query

  # 4. Fake-IP è¿‡æ»¤ (è§£å†³ PT çº¢ç§å’Œ IPv6 è¿æ¥é—®é¢˜)
  fake-ip-filter:
    - "*"
    - "+.lan"
    - "+.local"
    - "stun.*"
    - "time.*.com"
    - "ntp.*.com"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.byr.pt"         # å…³é”®ï¼šBYR ä¸èµ° Fake-IP
    - "+.edu.cn"         # å»ºè®®ï¼šæ•™è‚²ç½‘åŸŸåç›´è¿

# --- é”šç‚¹å‚æ•° ---
p: &p {type: http, interval: 86400, health-check: {enable: true, url: https://www.google.com/generate_204, interval: 300, timeout: 5000}}
pg: &pg {type: select, proxies: [Proxy, é¦™æ¸¯èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, DIRECT]}
url-test: &url-test {type: url-test, url: https://www.google.com/generate_204, interval: 300, tolerance: 50, include-all: true}
c: &c {type: http, behavior: classical, format: yaml, interval: 86400} # æ ¼å¼æ”¹ä¸º yaml æ›´ç¨³å¥

# --- ä»£ç†æä¾›å•† ---
proxy-providers:
  Subscribe:
    # å»ºè®®ç›´æ¥åœ¨ Verge Rev UI ä¸­å¡«å…¥è®¢é˜…é“¾æ¥ï¼Œè¿™é‡Œä»…ä½œå…¼å®¹ä¿ç•™
    url: http://127.0.0.1:38324/download/collection/AllServer
    <<: *p

# --- ç­–ç•¥ç»„ (ä¿æŒåŸæ ·ï¼Œé€»è¾‘æ¸…æ™°) ---
proxy-groups:
  - {name: é¦™æ¸¯èŠ‚ç‚¹, <<: *url-test, filter: "(?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong|HKG)\b)", icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/HongKong.png}
  - {name: ç¾å›½èŠ‚ç‚¹, <<: *url-test, filter: "(?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States|American|USA|SJC|JFK|LAX|ORD|ATL|DFW|SFO|MIA|SEA|IAD)\b)", icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/UnitedStates.png}
  - {name: ç‹®åŸèŠ‚ç‚¹, <<: *url-test, filter: "(?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore|SIN|XSP)\b)", icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Singapore.png}
  - {name: æ—¥æœ¬èŠ‚ç‚¹, <<: *url-test, filter: "(?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan|NRT|HND|KIX|CTS|FUK)\b)", icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Japan.png}
  - {name: å°æ¹¾èŠ‚ç‚¹, <<: *url-test, filter: "(?i)ğŸ‡¹ğŸ‡¼|ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|TPE|Taiwan|TSA|KHH)\b)", icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Taiwan.png}
  - {name: éŸ©å›½èŠ‚ç‚¹, <<: *url-test, filter: "(?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|å—æœé²œ|(\b(KR|KOR|Korea|South)\b)", icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Korea.png}
  - {name: Proxy, type: select, include-all: true, proxies: [é¦™æ¸¯èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, DIRECT], icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Proxy.png}
  
  # åº”ç”¨åˆ†ç»„
  - {name: AIGC, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/ChatGPT.png}
  - {name: Apple, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Apple.png}
  - {name: Disney, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Disney.png} 
  - {name: Github, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/GitHub.png}  
  - {name: Google, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Google.png}
  - {name: HBO, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/HBO.png}
  - {name: Microsoft, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Microsoft.png}
  - {name: Netflix, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Netflix.png} 
  - {name: OneDrive, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/OneDrive.png}  
  - {name: PayPal, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/PayPal.png}  
  - {name: Spotify, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Spotify.png}
  - {name: Telegram, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Telegram.png}
  - {name: TikTok, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/TikTok.png}   
  - {name: Twitter, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Twitter.png}
  - {name: WeChat, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/WeChat.png }
  - {name: YouTube, <<: *pg, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/YouTube.png}  
  - {name: Final, <<: *pg, include-all: true, icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Final.png}

# --- è§„åˆ™é›† (ä¿æŒåŸæ ·) ---
rule-providers:
  Reject: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Reject.yaml}
  AIGC: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/AIGC.yaml}  
  AppleCN: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Apple.yaml}
  AppleProxy: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/AppleProxy.yaml}
  Disney: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Disney.yaml}
  Github: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Github.yaml}
  Google: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Google.yaml}
  HBO: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/HBO.yaml}
  Microsoft: {<<: *c, url:https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Microsoft.yaml}
  Netflix: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Netflix.yaml}  
  OneDrive: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/OneDrive.yaml}
  PayPal: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/PayPal.yaml}
  Spotify: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Spotify.yaml}  
  Telegram: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Telegram.yaml}
  Twitter: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Twitter.yaml}
  TikTok: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/TikTok.yaml}
  WeChat: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/WeChat.yaml}  
  YouTube: {<<: *c, url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/YouTube.yaml}
  Proxy: {<<: *c, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Proxy/Proxy_Classical_No_Resolve.yaml}  
  Direct: {<<: *c, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Direct/Direct.yaml}
  Lan: {<<: *c, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml}  
  China: {<<: *c, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/ChinaMax/ChinaMax_Classical.yaml}

# --- è§„åˆ™ (é€»è¾‘ä¼˜åŒ–) ---
rules: 
  - RULE-SET,Reject,REJECT 
  # ä¼˜å…ˆåŒ¹é… PT ç«™ç‚¹ï¼Œç¡®ä¿ç›´è¿ + çœŸå® IP
  - DOMAIN-SUFFIX,byr.pt,DIRECT
  - DOMAIN-SUFFIX,edu.cn,DIRECT

  # åº”ç”¨åˆ†æµ
  - RULE-SET,AIGC,AIGC
  - RULE-SET,AppleCN,DIRECT
  - RULE-SET,AppleProxy,Proxy
  - RULE-SET,Disney,Disney  
  - RULE-SET,Github,Github
  - RULE-SET,Google,Google
  - RULE-SET,HBO,HBO
  - RULE-SET,Microsoft,Microsoft
  - RULE-SET,Netflix,Netflix  
  - RULE-SET,OneDrive,OneDrive
  - RULE-SET,PayPal,PayPal   
  - RULE-SET,Spotify,Spotify
  - RULE-SET,Telegram,Telegram
  - RULE-SET,Twitter,Twitter
  - RULE-SET,TikTok,TikTok
  - RULE-SET,WeChat,WeChat
  - RULE-SET,YouTube,YouTube
  - RULE-SET,Proxy,Proxy  
  - RULE-SET,Direct,DIRECT    
  - RULE-SET,Lan,DIRECT
  
  # å…œåº•ï¼šå…ˆåŒ¹é… GeoSite CNï¼Œå› ä¸ºå®ƒæ¯”åºå¤§çš„ IP åº“åŒ¹é…å¿«å¾—å¤š
  - GEOSITE,CN,DIRECT
  - RULE-SET,China,DIRECT  
  - GEOIP,CN,DIRECT
  - MATCH,Final
