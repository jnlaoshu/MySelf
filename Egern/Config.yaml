# ğ„ğ ğğ«ğ§@ğ¥ğšğ¨ğ¬ğ¡ğ®é…ç½®ä¿¡æ¯
# é…ç½®ä¸‹è½½ URL: https://raw.githubusercontent.com/jnlaoshu/MySelf/master/Egern/Config.yaml
# æ›´æ–°æ—¶é—´: 2025.09.16 17:18

# åŸºç¡€é…ç½®
ipv6: true
http_port: 3080
socks_port: 3090
allow_external_connections: true
vif_only: true
hide_vpn_icon: false
# æ–°å¢è¿æ¥è¶…æ—¶è®¾ç½®ï¼Œé¿å…é•¿æœŸæ— å“åº”è¿æ¥
tcp_timeout: 300
udp_timeout: 60
hijack_dns:
  - '*:53'
  # æ’é™¤æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œé¿å…å½±å“å±€åŸŸç½‘è®¾å¤‡
  - '!192.168.0.0/16:53'
  - '!10.0.0.0/8:53'
# æ•°æ®åº“ URL é…ç½®
geoip_db_url: 
  - https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb
asn_db_url: 
  - https://raw.githubusercontent.com/P3TERX/GeoLite.mmdb/download/GeoLite2-ASN.mmdb
# å»¶è¿Ÿæµ‹è¯• URL é…ç½®ï¼ˆå¤šåœ°å€è½®è¯¢ï¼Œæå‡ç¨³å®šæ€§ï¼‰
proxy_latency_test_url: 
  - http://cp.cloudflare.com/generate_204
  - https://www.google.com/generate_204
  - https://www.apple.com/library/test/success.html
direct_latency_test_url: 
  - http://www.apple.com/library/test/success.html
  - http://www.baidu.com/favicon.ico
dns:
  bootstrap:
    - 223.5.5.5
    - 119.29.29.29
    - 180.184.1.1
    - 8.8.8.8  # å¤‡ç”¨æµ·å¤–bootstrap
  upstreams:
    Domestic:
      - quic://dns.alidns.com:853
      - https://doh.pub/dns-query
      - https://dns.pub/dns-query  # æ–°å¢å¤‡ç”¨å›½å†…DNS
    Foreign:
      - https://dns.google/dns-query
      - https://1.1.1.1/dns-query  # Cloudflareå¤‡ç”¨
      - quic://dns.cloudflare.com:853
  forward:
    - proxy_rule_set:
        match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Proxy/Proxy_All.list
        value: Foreign
    - regex:
        match: ^ad(s?)\.
        value: quic://dns.adguard-dns.com
    - wildcard:
        match: '*'
        value: Domestic
  # æ–°å¢DNSç¼“å­˜é…ç½®
  cache: true
  cache_size: 1024
  cache_ttl: 300  # ç¼“å­˜5åˆ†é’Ÿ
  hosts:
    dns.alidns.com: 223.5.5.5, 223.6.6.6, 2400:3200:baba::1, 2400:3200::1
    doh.pub: 1.12.12.12, 120.53.53.53
    dns.google: 8.8.8.8, 8.8.4.4, 2001:4860:4860::8888, 2001:4860:4860::8844
  public_ip_lookup_url: https://ifconfig.me/ip
policy_groups:
- auto_test:
    name: é¦™æ¸¯èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡­ğŸ‡°|é¦™æ¸¯|HK|Hong
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/HongKong.png
    interval: 300  # 5åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡
    timeout: 5000  # è¶…æ—¶5ç§’è§†ä¸ºæ— æ•ˆ
- auto_test:
    name: ç¾å›½èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡ºğŸ‡¸|ç¾å›½|US|States|American
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/UnitedStates.png
    interval: 300
    timeout: 5000
- auto_test:
    name: å°æ¹¾èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡¹ğŸ‡¼|å°æ¹¾|TW|Tai
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Taiwan.png
    interval: 300
    timeout: 5000	
- auto_test:
    name: æ—¥æœ¬èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|JP|Japan
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Japan.png
    interval: 300
    timeout: 5000	
- auto_test:
    name: ç‹®åŸèŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Singapore.png
    interval: 300
    timeout: 5000	
- auto_test:
    name: éŸ©å›½èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡°ğŸ‡·|éŸ©å›½|KR|KOR|Korea
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Korea.png
    interval: 300
    timeout: 5000	
- select:
    name: å…¶ä»–èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ^((?!ğŸ‡­ğŸ‡°|é¦™æ¸¯|HK|Hong|ğŸ‡¹ğŸ‡¼|å°æ¹¾|TW|Tai|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|JP|Japan|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|ğŸ‡°ğŸ‡·|éŸ©å›½|KR|KOR|Korea|ğŸ‡ºğŸ‡¸|ç¾å›½|US|States|American).)*$
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/WorldMap.png
    hidden: true
# åº”ç”¨ç­–ç•¥ç»„è¡¥å……ä¼˜å…ˆçº§è¯´æ˜
- select:
    name: AIGC
    policies:
    - ç¾å›½ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/ChatGPT.png
    description: "AIGCæœåŠ¡ä¼˜å…ˆä½¿ç”¨ç¾å›½èŠ‚ç‚¹ï¼ˆå¦‚ChatGPTã€Claudeç­‰ï¼‰"
- select:
    name: Apple
    policies:
    - DIRECT
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Apple.png
- select:
    name: Disney
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Disney.png    
- select:
    name: Google
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Google.png
- select:
    name: HBO
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/HBO.png	
- select:
    name: Microsoft
    policies:
    - DIRECT
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Microsoft.png
- select:
    name: Netflix
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Netflix.png	
- select:
    name: PayPal
    policies:
    - ç¾å›½èŠ‚ç‚¹
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/PayPal.png
- select:
    name: Spotify
    policies:
    - ç¾å›½ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Spotify.png    
- select:
    name: Telegram
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Telegram.png
- select:
    name: TikTok
    policies:
    - æ—¥æœ¬ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/TikTok.png    
- select:
    name: Twitter
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Twitter.png
- select:
    name: WeChat
    policies:
    - DIRECT
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/WeChat.png
- select:
    name: YouTube
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/YouTube.png
- external:
    name: AllServer
    type: select
    urls:
    - https://sub.store/download/collection/AllServer?target=Egern
    icon: ğŸŒ¹ 
- select:
    name: é¦™æ¸¯ä¼˜å…ˆ
    policies:
    - é¦™æ¸¯èŠ‚ç‚¹
    - ç¾å›½èŠ‚ç‚¹
    - ç‹®åŸèŠ‚ç‚¹
    - å°æ¹¾èŠ‚ç‚¹
    - æ—¥æœ¬èŠ‚ç‚¹
    - éŸ©å›½èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ˜œ
- select:
    name: ç¾å›½ä¼˜å…ˆ
    policies:
    - ç¾å›½èŠ‚ç‚¹
    - é¦™æ¸¯èŠ‚ç‚¹
    - ç‹®åŸèŠ‚ç‚¹
    - å°æ¹¾èŠ‚ç‚¹
    - æ—¥æœ¬èŠ‚ç‚¹
    - éŸ©å›½èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ¤£
- select:
    name: æ—¥æœ¬ä¼˜å…ˆ
    policies:
    - æ—¥æœ¬èŠ‚ç‚¹    
    - ç¾å›½èŠ‚ç‚¹
    - å°æ¹¾èŠ‚ç‚¹    
    - éŸ©å›½èŠ‚ç‚¹
    - ç‹®åŸèŠ‚ç‚¹
    - é¦™æ¸¯èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ˜Š
rules:
  # å¹¿å‘Šæ‹¦æˆªè§„åˆ™å‰ç½®ï¼ˆé«˜é¢‘åŒ¹é…ï¼‰
  - domain_regex:
      match: ^ad(s?)\..*
      policy: REJECT
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Reject.yaml
      policy: REJECT
  # ç‰¹æ®ŠæœåŠ¡è§„åˆ™ï¼ˆæŒ‰è®¿é—®é¢‘ç‡æ’åºï¼‰
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/WeChat.yaml
      policy: WeChat
      description: "å¾®ä¿¡æœåŠ¡ä¼˜å…ˆç›´è¿"
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Google.yaml
      policy: Google
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/YouTube.yaml
      policy: YouTube
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Telegram.yaml
      policy: Telegram
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/TikTok.yaml
      policy: TikTok
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Twitter.yaml
      policy: Twitter
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/AIGC.yaml
      policy: AIGC	  
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Microsoft.yaml
      policy: Microsoft
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/AppleProxy.yaml
      policy: ç¾å›½ä¼˜å…ˆ
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Apple.yaml
      policy: Apple
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Bing.yaml
      policy: ç¾å›½ä¼˜å…ˆ
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Disney.yaml
      policy: Disney
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/HBO.yaml
      policy: HBO
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Netflix.yaml
      policy: Netflix
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/PayPal.yaml
      policy: PayPal
  - rule_set:
      match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Spotify.yaml
      policy: Spotify
  - rule_set:
      match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Proxy/Proxy_All.list
      policy: é¦™æ¸¯ä¼˜å…ˆ
  # å›½å†…æœåŠ¡ç›´è¿è§„åˆ™å‰ç½®
  - domain_suffix:
      match: '*.cn'
      policy: DIRECT
      description: "æ‰€æœ‰.cnåç¼€åŸŸåç›´è¿"
  - geoip:
      match: CN
      policy: DIRECT
      no_resolve: true
      description: "ä¸­å›½IPæ®µç›´è¿"
  - ip_cidr:
      match: 192.168.0.0/16, 10.0.0.0/8, 127.0.0.0/8, 172.16.0.0/12, 192.128.0.0/16, 224.0.0.0/24, fe80::/10  # è¡¥å……ipv6æœ¬åœ°ç½‘æ®µ
      policy: DIRECT
      description: "æœ¬åœ°å±€åŸŸç½‘ç›´è¿"
  # æœ€ååŒ¹é…é»˜è®¤ç­–ç•¥
  - default:
      policy: é¦™æ¸¯ä¼˜å…ˆ
# MITM é…ç½®ï¼ˆé™åˆ¶åŸŸåèŒƒå›´ï¼Œå‡å°‘å®‰å…¨é£é™©ï¼‰
mitm:
  enabled: true
  ca_p12: egern.p12
  ca_passphrase: egern
  # ä»…å¯¹éœ€è¦è§£å¯†çš„åŸŸåå¯ç”¨MITM
  hostnames:
    - '*.google.com'
    - '*.youtube.com'
    - '*.twitter.com'
    - '*.openai.com'
# æ¨¡å—é…ç½®ï¼ˆæ·»åŠ æ›´æ–°é—´éš”ï¼‰
modules:
  - url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Module/Panel.yaml
    enabled: true
    interval: 86400  # æ¯å¤©æ›´æ–°ä¸€æ¬¡
  - name: Sub-Store
    url: https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Egern.yaml
    enabled: true
    interval: 86400
  - name: ScriptHub
    url: https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.surge.sgmodule
    enabled: true
  - name: BoxJs
    url: https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.surge.sgmodule
    enabled: true
  - name: 'Spotify'
    url: https://raw.githubusercontent.com/app2smile/rules/master/module/spotify.module
    enabled: true
  - name: 'YouTube Enhance'
    url: https://raw.githubusercontent.com/Maasea/sgmodule/master/YouTube.Enhance.sgmodule
    enabled: true
  - name: 'BiliBiliå»å¹¿å‘Š'
    url: https://raw.githubusercontent.com/app2smile/rules/master/module/bilibili.sgmodule
    enabled: true  
  - name: å¢¨é±¼å»å¹¿å‘Šæ¨¡å—
    url: https://raw.githubusercontent.com/ddgksf2013/Modules/main/Adblock.sgmodule
    enabled: true
    interval: 86400  # æ¯å¤©æ›´æ–°ä¸€æ¬¡
