# > ğ¥ğšğ¨ğ¬ğ¡ğ®@ğ„ğ ğğ«ğ§ è‡ªç”¨é…ç½®
# > é…ç½®ä¸‹è½½ğ”ğ‘ğ‹ï¼š https://raw.githubusercontent.com/jnlaoshu/MySelf/master/Egern/Profile.yaml
# > ğ”ğ©ğğšğ­ğ: 2025.01.15 09:00

# > å¼€å¯ipv6æ”¯æŒ
ipv6: true 

# > å…è®¸å¤–éƒ¨è¿æ¥é€šè¿‡ Wi-Fi è®¿é—®è®¾å¤‡ä¸Šçš„ä»£ç†
allow_external_connections: true

# > ä»…è™šæ‹Ÿç½‘æ¥å£æ¨¡å¼
vif_only: true

# > éšè— VPN å›¾æ ‡
hide_vpn_icon: false

# > DNS åŠ«æŒ
hijack_dns:
- '*:53'

# > æŒ‡å®šè‡ªå®šä¹‰çš„ GeoIP æ•°æ®åº“ URL
geoip_db_url: https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb
# > æŒ‡å®šè‡ªå®šä¹‰çš„ ASN æ•°æ®åº“ URL
asn_db_url: https://raw.githubusercontent.com/P3TERX/GeoLite.mmdb/download/GeoLite2-ASN.mmdb

# > è‡ªå®šä¹‰çš„ä»£ç†å»¶è¿Ÿæµ‹è¯• URL
proxy_latency_test_url: http://cp.cloudflare.com/generate_204
# > è‡ªå®šä¹‰çš„ç›´è¿å»¶è¿Ÿæµ‹è¯• URL
direct_latency_test_url: http://www.apple.com/library/test/success.html

# > è™šæ‹Ÿç½‘ç»œæ¥å£ä¸ä½¿ç”¨é»˜è®¤çš„è·¯ç”±ï¼Œç”±å¤šä¸ªè¾ƒå°çš„è·¯ç”±åˆ‡åˆ†ç”¨äºè§£å†³æŸäº›é—®é¢˜ã€‚æ¯”å¦‚HomeKitçš„æ‘„åƒå¤´æ— æ³•ä½¿ç”¨çš„é—®é¢˜
compat_route: false

# > å¯ç”¨åç³»ç»Ÿä¼šé€šè¿‡éš§é“è·¯ç”±ç½‘ç»œæµé‡ï¼Œä½†ä¸ºç»´æŒé¢„æœŸè®¾å¤‡åŠŸèƒ½æ‰€å¿…éœ€çš„æŒ‡å®šç³»ç»ŸæœåŠ¡çš„æµé‡é™¤å¤–
include_all_networks: false

# > å¯ç”¨åç³»ç»Ÿå°†åŒ…å« Apple Push Notification æœåŠ¡ (APN) æµé‡ï¼Œä½†å‰ææ˜¯åŒ…å«æ‰€æœ‰ç½‘ç»œä¹Ÿå·²å¯ç”¨
include_apns: false

# > å¯ç”¨åç³»ç»Ÿä¼šåŒ…å«èœ‚çªç½‘ç»œæœåŠ¡ï¼Œå¦‚ Wi-Fi é€šè¯ã€å½©ä¿¡ã€çŸ­ä¿¡å’Œå¯è§†è¯­éŸ³é‚®ä»¶ï¼Œä½†å‰ææ˜¯åŒ…å«æ‰€æœ‰ç½‘ç»œä¹Ÿå·²å¯ç”¨ã€‚è¯¥å±æ€§ä¸ä¼šå½±å“ä»…ä½¿ç”¨èœ‚çªç½‘ç»œçš„æœåŠ¡ï¼ˆå¦‚ VoLTEï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ’é™¤è¿™äº›æœåŠ¡
include_cellular_services: false

# > å¯ç”¨åç³»ç»Ÿå°†åŒ…å«ä¸æœ¬åœ°ç½‘ç»œä¸Šä¸»æœºï¼ˆå¦‚ AirPlayã€AirDrop å’Œ CarPlayï¼‰çš„ç½‘ç»œè¿æ¥ï¼Œä½†å‰ææ˜¯åŒ…å«æ‰€æœ‰ç½‘ç»œä¹Ÿå·²å¯ç”¨ã€‚é»˜è®¤å€¼æ˜¯ false
include_local_networks: false

dns:
  bootstrap:
    - 119.29.29.29
    - 223.5.5.5	
  upstreams:  # å®šä¹‰ä¸Šæ¸¸DNSæœåŠ¡å™¨çš„åˆ—è¡¨
    Domestic: #ä½¿ç”¨å›½å†…å…¬å…±DNSæœåŠ¡å™¨ä½œä¸ºä¸Šæ¸¸æœåŠ¡å™¨
    - https://doh.pub/dns-query 
    - https://dns.alidns.com/dns-query	
    Foreign: #ä½¿ç”¨Googleçš„å…¬å…±DNSæœåŠ¡å™¨ä½œä¸ºä¸Šæ¸¸æœåŠ¡å™¨
    - tls://8.8.8.8

# > è½¬å‘DNSè¯·æ±‚çš„è§„åˆ™
  forward:  
  - wildcard:
      match: '*.cn'  # å°†æ‰€æœ‰ä»¥.cnç»“å°¾çš„åŸŸåè¯·æ±‚è½¬å‘ç»™å›½å†…å…¬å…±DNSæœåŠ¡å™¨
      value: Domestic
  - proxy_rule_set:  # åŒ¹é… ACL4SSR çš„ä¸­å›½åŸŸååˆ—è¡¨ä¸­çš„åŸŸå
      match: https://github.com/ACL4SSR/ACL4SSR/raw/master/Clash/ChinaDomain.list
      value: Domestic  # è¿™äº›åŒ¹é…çš„åŸŸåä½¿ç”¨å›½å†…å…¬å…±DNSæœåŠ¡å™¨
  - proxy_rule_set:
      match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/ChinaMax/ChinaMax.list
      value: Domestic  # è¿™äº›åŒ¹é…çš„åŸŸåä½¿ç”¨å›½å†…å…¬å…±DNSæœåŠ¡å™¨
  - regex:
      match: ^ad\..*|^ads\..*  # æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä»¥"ad."æˆ–"ads."å¼€å¤´çš„åŸŸåï¼ˆé€šå¸¸æ˜¯å¹¿å‘Šç›¸å…³çš„åŸŸåï¼‰
      value: quic://dns.adguard-dns.com  # è¿™äº›å¹¿å‘Šç›¸å…³çš„åŸŸåä½¿ç”¨AdGuardçš„QUIC DNSæœåŠ¡å™¨
  - wildcard:
      match: '*'  # åŒ¹é…æ‰€æœ‰å…¶ä»–æœªè¢«å‰è¿°è§„åˆ™åŒ¹é…çš„åŸŸå
      value: Foreign  # å°†è¿™äº›åŸŸåè¯·æ±‚è½¬å‘åˆ°ç³»ç»Ÿé»˜è®¤çš„DNSæœåŠ¡å™¨

# > æœ¬åœ°DNSè§£æçš„ä¸»æœºåæ˜ å°„
  hosts: 
    dns.alidns.com: 223.5.5.5, 223.6.6.6, 2400:3200:baba::1, 2400:3200::1 # https://dns.alidns.com/dns-query
    doh.pub: 1.12.12.12, 120.53.53.53 # https://doh.pub/dns-query
    dot.pub: 1.12.12.12, 120.53.53.53 # dot.pub:853	
    dns.google: 8.8.8.8, 8.8.4.4, 2001:4860:4860::8888, 2001:4860:4860::8844 # https://dns.google/dns-query
    dns64.dns.google: 2001:4860:4860::6464, 2001:4860:4860::64 # https://dns64.dns.google/dns-query

# > æŸ¥è¯¢å…¬å…±IPåœ°å€çš„URLï¼Œç”¨äºè·å–æœ¬æœºçš„å…¬ç½‘IPåœ°å€  
  public_ip_lookup_url: https://ifconfig.me/ip  

# > ç­–ç•¥ç»„é…ç½®åˆ—è¡¨
policy_groups:
- external:
    name: AllServer
    type: select
    urls:
    - https://sub.store/download/collection/AllServer?target=Egern
    icon: ğŸŒ¹   
- select:
    name: Apple
    policies:
    - DIRECT
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
- select:
    name: AIGC
    policies:
    - ç¾å›½ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/ChatGPT.png    
- select:
    name: Google
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google_Search.png
- select:
    name: Microsoft
    policies:
    - DIRECT
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Microsoft.png
- select:
    name: PayPal
    policies:
    - ç¾å›½èŠ‚ç‚¹
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/PayPal.png
- select:
    name: Spotify
    policies:
    - ç¾å›½ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Spotify.png    
- select:
    name: Telegram
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
- select:
    name: TikTok
    policies:
    - æ—¥æœ¬ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/TikTok.png    
- select:
    name: Twitter
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Twitter.png
- select:
    name: WeChat
    policies:
    - DIRECT
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/WeChat.png
- select:
    name: YouTube
    policies:
    - é¦™æ¸¯ä¼˜å…ˆ
    flatten: true
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
- auto_test:
    name: é¦™æ¸¯èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡­ğŸ‡°|æ¸¯|é¦™æ¸¯|HK|Hong
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
- auto_test:
    name: ç¾å›½èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡ºğŸ‡¸|ç¾|ç¾å›½|US|States|American
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png
- auto_test:
    name: å°æ¹¾èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡¹ğŸ‡¼|å°|å°æ¹¾|TW|Tai
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png
- auto_test:
    name: æ—¥æœ¬èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡¯ğŸ‡µ|æ—¥|æ—¥æœ¬|JP|Japan
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
- auto_test:
    name: ç‹®åŸèŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡¸ğŸ‡¬|æ–°|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
- auto_test:
    name: éŸ©å›½èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ğŸ‡°ğŸ‡·|éŸ©|éŸ©å›½|KR|KOR|Korea
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png    
- select:
    name: å…¶ä»–èŠ‚ç‚¹
    policies:
    - AllServer
    flatten: true
    filter: ^((?!ğŸ‡­ğŸ‡°|æ¸¯|HK|Hong|ğŸ‡¹ğŸ‡¼|å°|TW|Tai|ğŸ‡¯ğŸ‡µ|æ—¥|JP|Japan|ğŸ‡¸ğŸ‡¬|å¡|ç‹®åŸ|SG|Singapore|ğŸ‡°ğŸ‡·|éŸ©|KR|KOR|Korea|ğŸ‡ºğŸ‡¸|ç¾|US|States|American|Music).)*$
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/World_Map.png
- select:
    name: é¦™æ¸¯ä¼˜å…ˆ
    policies:
    - é¦™æ¸¯èŠ‚ç‚¹
    - ç¾å›½èŠ‚ç‚¹
    - ç‹®åŸèŠ‚ç‚¹
    - å°æ¹¾èŠ‚ç‚¹
    - æ—¥æœ¬èŠ‚ç‚¹
    - éŸ©å›½èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ˜œ
- select:
    name: ç¾å›½ä¼˜å…ˆ
    policies:
    - ç¾å›½èŠ‚ç‚¹
    - é¦™æ¸¯èŠ‚ç‚¹
    - ç‹®åŸèŠ‚ç‚¹
    - å°æ¹¾èŠ‚ç‚¹
    - æ—¥æœ¬èŠ‚ç‚¹
    - éŸ©å›½èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ¤£
- select:
    name: æ—¥æœ¬ä¼˜å…ˆ
    policies:
    - æ—¥æœ¬èŠ‚ç‚¹    
    - ç¾å›½èŠ‚ç‚¹
    - å°æ¹¾èŠ‚ç‚¹    
    - éŸ©å›½èŠ‚ç‚¹
    - ç‹®åŸèŠ‚ç‚¹
    - é¦™æ¸¯èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ˜Š

# > ä»£ç†è§„åˆ™åˆ—è¡¨
rules:
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppStore/AppStore.list
    policy: DIRECT	
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple.list
    policy: Apple
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple_Domain.list
    policy: Apple
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/refs/heads/main/Surge/Rules/AI.list
    policy: AIGC    
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Google/Google.list
    policy: Google
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Microsoft/Microsoft.list
    policy: Microsoft
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/PayPal/PayPal.list
    policy: PayPal    
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Spotify/Spotify.list
    policy: Spotify
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Telegram/Telegram.list
    policy: Telegram
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/refs/heads/main/Egern/Rule/TikTok.yaml
    policy: TikTok    
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Twitter/Twitter.list
    policy: Twitter
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/WeChat/WeChat.list
    policy: WeChat    
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/YouTube/YouTube.list
    policy: YouTube
- geoip:
    match: CN
    policy: DIRECT
- default:
    policy: é¦™æ¸¯ä¼˜å…ˆ

# > MITM é…ç½®
mitm:
  enabled: true
  ca_p12: egern.p12
  ca_passphrase: egern

# > æ¨¡å—é…ç½®åˆ—è¡¨
modules:
- name: BoxJs
  url: https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.surge.sgmodule
  enabled: true
- name: ScriptHub
  url: https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.surge.sgmodule
  enabled: true
- name: Sub-Store
  url: https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Egern.yaml  
  enabled: true
- name: 'Spotify'
  url: https://raw.githubusercontent.com/app2smile/rules/master/module/spotify.module
  enabled: true
- name: 'BiliBili Enhanced'
  url: https://github.com/BiliUniverse/Enhanced/releases/latest/download/BiliBili.Enhanced.yaml
  enabled: true
- name: 'iRingo TestFlight'
  url: https://github.com/NSRingo/TestFlight/releases/latest/download/iRingo.TestFlight.yaml
  enabled: true
- name: 'iRingo Siri'
  url: https://github.com/NSRingo/Siri/releases/latest/download/iRingo.Siri.yaml
  enabled: true
- name: 'iRingo WeatherKit'
  url: https://github.com/NSRingo/WeatherKit/releases/latest/download/iRingo.WeatherKit.yaml
  enabled: true  
- name: 'YouTube Enhance'
  url: https://raw.githubusercontent.com/Maasea/sgmodule/master/YouTube.Enhance.sgmodule
  enabled: true
- name: å¾®ä¿¡å¤–éƒ¨é“¾æ¥è§£é”
  url: https://raw.githubusercontent.com/QingRex/LoonKissSurge/refs/heads/main/Surge/Beta/%E5%BE%AE%E4%BF%A1%E5%A4%96%E9%83%A8%E9%93%BE%E6%8E%A5%E8%A7%A3%E9%94%81.beta.sgmodule
  enabled: true
- name: fmz200é‡å†™å»å¹¿å‘Š
  url: http://script.hub/file/_start_/https://raw.githubusercontent.com/fmz200/wool_scripts/main/QuantumultX/rewrite/chongxie.txt/_end_/chongxie.sgmodule?n=fmz200%20%E9%87%8D%E5%86%99%E5%8E%BB%E5%B9%BF%E5%91%8A&type=qx-rewrite&target=surge-module&del=true
  enabled: true
- name: fmz200å¹¿å‘Šæ‹¦æˆªå‡€åŒ–åˆé›†
  url: http://script.hub/file/_start_/https://raw.githubusercontent.com/fmz200/wool_scripts/main/Loon/plugin/blockAds.plugin/_end_/blockAds.sgmodule?type=loon-plugin&target=surge-module&del=true
  enabled: true
- name: å¢¨é±¼å»å¹¿å‘Š
  url: https://raw.githubusercontent.com/ddgksf2013/Modules/main/Adblock.sgmodule
  enabled: true
- name: å¯è‰å¹¿å‘Šè¿‡æ»¤å™¨
  url: https://raw.githubusercontent.com/QingRex/LoonKissSurge/refs/heads/main/Surge/Beta/%E5%8F%AF%E8%8E%89%E5%B9%BF%E5%91%8A%E8%BF%87%E6%BB%A4%E5%99%A8.beta.sgmodule
  enabled: true
