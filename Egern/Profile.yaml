# ğ„ğ ğğ«ğ§@ğ¥ğšğ¨ğ¬ğ¡ğ®ä¸“ç”¨é…ç½®
# æ›´æ–°æ—¶é—´: 2026.02.07 23:30

# è‡ªåŠ¨æ›´æ–°é…ç½® (å¦‚éœ€å¯ç”¨è¯·å–æ¶ˆæ³¨é‡Š)
# auto_update:
#   url: https://raw.githubusercontent.com/jnlaoshu/MySelf/master/Egern/Profile.yaml
#   interval: 86400

# --- åŸºç¡€é…ç½® ---
ipv6: true
http_port: 3080
socks_port: 3090
allow_external_connections: true
vif_only: true
hide_vpn_icon: true

# --- DNS åŠ«æŒ ---
hijack_dns: 
  - '*:53'

# --- æ•°æ®åº“ URL é…ç½® ---
geoip_db_url: https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb
asn_db_url: https://raw.githubusercontent.com/Loyalsoldier/geoip/release/GeoLite2-ASN.mmdb

# --- å»¶è¿Ÿæµ‹è¯• ---
# ä»£ç†æµ‹é€Ÿï¼š
proxy_latency_test_url: http://www.gstatic.com/generate_204
# ç›´è¿æµ‹é€Ÿï¼š
direct_latency_test_url: http://www.apple.com/library/test/success.html

# --- è·¯ç”±é…ç½® ---
compat_route: false
include_all_networks: false
include_apns: false
include_cellular_services: false
include_local_networks: false

# --- DNS é…ç½® ---
dns:
  # 1. å¼•å¯¼ DNS
  bootstrap:
  - 223.5.5.5
  - 119.29.29.29
  - 2400:3200::1

  # 2. ä¸Šæ¸¸ DNS
  upstreams:
    System:
    - system
    Alibaba:
    - https://dns.alidns.com/dns-query
    ByteDance:
    - 180.184.1.1
    - 180.184.2.2
    Tencent:
    - https://doh.pub/dns-query
    Google:
    - https://8.8.8.8/dns-query
    - https://dns.google/dns-query
    China:
    - https://doh.pub/dns-query	
    - https://dns.alidns.com/dns-query
    Global:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - https://dns.cloudflare.com/dns-query

  # 3. DNS åˆ†æµè½¬å‘
  forward:
  # --- å±€åŸŸç½‘ä¸ç‰¹æ®Š ---
  - wildcard:
      match: '*.lan'
      value: System
  - wildcard:
      match: '*.local'
      value: System
  - wildcard:
      match: '*.home'
      value: System
  - wildcard:
      match: '*.ntp.org'
      value: System

  # --- Apple ä¼˜åŒ–ç­–ç•¥ ---
  - wildcard:
      match: '*.mzstatic.com'
      value: Tencent
  - wildcard:
      match: '*.icloud-content.com'
      value: Tencent
  - wildcard:
      match: 'push.apple.com'
      value: Tencent
  - wildcard:
      match: 'time.apple.com'
      value: System

  # --- å¾®è½¯ä¸æ¸¸æˆ ---
  - wildcard:
      match: '*.steampowered.com'
      value: Tencent
  - wildcard:
      match: '*.steamstatic.com'
      value: Tencent
  - wildcard:
      match: '*.microsoft.com'
      value: China
  - wildcard:
      match: '*.windowsupdate.com'
      value: China

  # --- Google æ·±åº¦åˆ†æµ ---
  - wildcard:
      match: '*.google.com'
      value: Google
  - wildcard:
      match: '*.googleapis.com'
      value: Google
  - wildcard:
      match: '*.gstatic.com'
      value: Google
  - wildcard:
      match: '*.youtube.com'
      value: Google
  - wildcard:
      match: '*.ytimg.com'
      value: Google
  - wildcard:
      match: '*.ggpht.com'
      value: Google

  # --- å›½å†…å¤§å‚ç²¾ç¡®åˆ†æµ ---
  # é˜¿é‡Œç³»
  - wildcard:
      match: '*.alibaba.com'
      value: Alibaba
  - wildcard:
      match: '*.taobao.com'
      value: Alibaba
  - wildcard:
      match: '*.tmall.com'
      value: Alibaba
  - wildcard:
      match: '*.alicdn.com'
      value: Alibaba
  - wildcard:
      match: '*.alipay.com'
      value: Alibaba

  # è…¾è®¯ç³»
  - wildcard:
      match: '*.qq.com'
      value: Tencent
  - wildcard:
      match: '*.tencent.com'
      value: Tencent
  - wildcard:
      match: '*.weixin.com'
      value: Tencent
  - wildcard:
      match: '*.WeChat.com'
      value: Tencent

  # å­—èŠ‚ç³» (å¼ºåˆ¶èµ°å›½å†…DNS)
  - wildcard:
      match: '*.douyin.com'
      value: ByteDance
  - wildcard:
      match: '*.snssdk.com'
      value: ByteDance
  - wildcard:
      match: '*.amemv.com'
      value: ByteDance
  - wildcard:
      match: '*.ixigua.com'
      value: ByteDance
  - wildcard:
      match: '*.pstatp.com'
      value: ByteDance
  - wildcard:
      match: '*.toutiaoimg.com'
      value: ByteDance
  - wildcard:
      match: '*.byteimg.com'
      value: ByteDance
  
  # TikTok å›½é™…ç‰ˆä¿æŒé»˜è®¤
  - wildcard:
      match: '*.tiktokcdn.com'
      value: Global

  # --- å…œåº• ---
  - wildcard:
      match: '*.cn'
      value: China
  - wildcard:
      match: '*'
      value: Global

  public_ip_lookup_url: https://ifconfig.me/ip

# --- ç­–ç•¥ç»„é…ç½® ---
policy_groups:
# 1. åœ°åŒºè‡ªåŠ¨æµ‹é€Ÿç»„
- auto_test:
    name: é¦™æ¸¯è‡ªåŠ¨
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ğŸ‡­ğŸ‡°|é¦™æ¸¯|HK|Hong
    url: http://www.gstatic.com/generate_204
    interval: 300
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/HongKong.png

- auto_test:
    name: ç¾å›½è‡ªåŠ¨
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ğŸ‡ºğŸ‡¸|ç¾å›½|US|States|American
    url: http://www.gstatic.com/generate_204
    interval: 300
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/UnitedStates.png

- auto_test:
    name: å°æ¹¾è‡ªåŠ¨
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ğŸ‡¹ğŸ‡¼|å°æ¹¾|TW|Tai
    url: http://www.gstatic.com/generate_204
    interval: 300
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Taiwan.png

- auto_test:
    name: æ—¥æœ¬è‡ªåŠ¨
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|JP|Japan
    url: http://www.gstatic.com/generate_204
    interval: 300
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Japan.png

- auto_test:
    name: ç‹®åŸè‡ªåŠ¨
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore
    url: http://www.gstatic.com/generate_204
    interval: 300
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Singapore.png

- auto_test:
    name: éŸ©å›½è‡ªåŠ¨
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ğŸ‡°ğŸ‡·|éŸ©å›½|KR|KOR|Korea
    url: http://www.gstatic.com/generate_204
    interval: 300
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Korea.png

- select:
    name: å…¶ä»–èŠ‚ç‚¹
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    filter: ^((?!ğŸ‡­ğŸ‡°|é¦™æ¸¯|HK|Hong|ğŸ‡¹ğŸ‡¼|å°æ¹¾|TW|Tai|ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|JP|Japan|ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore|ğŸ‡°ğŸ‡·|éŸ©å›½|KR|KOR|Korea|ğŸ‡ºğŸ‡¸|ç¾å›½|US|States|American).)*$
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/WorldMap.png

# 2. èŠ‚ç‚¹æºä¸å…¨å±€è‡ªåŠ¨
- external:
    name: å…¨éƒ¨èŠ‚ç‚¹
    type: select
    urls:
    - https://sub.store/download/collection/AllServer?target=Egern 
    icon: ğŸŒ¹

- auto_test:
    name: è‡ªåŠ¨ä¼˜é€‰
    policies:
    - å…¨éƒ¨èŠ‚ç‚¹
    flatten: true
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Auto.png

# 3. æ€»æ§åˆ¶ç­–ç•¥
- select:
    name: è‡ªé€‰ç­–ç•¥
    policies:
    - è‡ªåŠ¨ä¼˜é€‰
    - é¦™æ¸¯è‡ªåŠ¨
    - ç¾å›½è‡ªåŠ¨
    - ç‹®åŸè‡ªåŠ¨
    - æ—¥æœ¬è‡ªåŠ¨
    - å°æ¹¾è‡ªåŠ¨
    - éŸ©å›½è‡ªåŠ¨
    - DIRECT
    - å…¨éƒ¨èŠ‚ç‚¹
    - å…¶ä»–èŠ‚ç‚¹
    icon: ğŸ˜œ

# 4. åœºæ™¯åŒ–æœåŠ¡ç­–ç•¥
- select:
    name: AIGC
    policies:
    - ç¾å›½è‡ªåŠ¨
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/ChatGPT.png

- select:
    name: Apple
    policies:
    - ç¾å›½è‡ªåŠ¨
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Apple.png

- select:
    name: Disney
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Disney.png

- select:
    name: GitHub
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/GitHub.png

- select:
    name: Google
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Google.png

- select:
    name: HBO
    policies:
    - ç¾å›½è‡ªåŠ¨
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/HBO.png

- select:
    name: Microsoft
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Microsoft.png

- select:
    name: Netflix
    policies:
    - ç‹®åŸè‡ªåŠ¨
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Netflix.png

- select:
    name: PayPal
    policies:
    - ç¾å›½è‡ªåŠ¨
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/PayPal.png

- select:
    name: Spotify
    policies:
    - ç¾å›½è‡ªåŠ¨
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Spotify.png

- select:
    name: Telegram
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Telegram.png

- select:
    name: TikTok
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/TikTok.png

- select:
    name: Twitter
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/Twitter.png

- select:
    name: WeChat
    policies:
    - DIRECT
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/WeChat.png

- select:
    name: YouTube
    policies:
    - è‡ªåŠ¨ä¼˜é€‰
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/YouTube.png

- select:
    name: YouTubeMusic
    policies:
    - è‡ªé€‰ç­–ç•¥
    flatten: true
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/YouTubeMusic.png

# --- å»å¹¿å‘Šä¸“ç”¨ç­–ç•¥ç»„ ---
- select:
    name: çŒæ€å¹¿å‘Š
    policies:
    - REJECT
    - REJECT-DROP
    flatten: false
    icon: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/image/AdBlock.png

rules:
# 1. å¹¿å‘Šæ‹¦æˆª
- rule_set:
    match: https://raw.githubusercontent.com/Repcz/Tool/refs/heads/X/Egern/Rules/AdGuardChinese.yaml
    policy: çŒæ€å¹¿å‘Š
- rule_set:
    match: https://raw.githubusercontent.com/Repcz/Tool/refs/heads/X/Egern/Rules/Ads_SukkaW.yaml
    policy: çŒæ€å¹¿å‘Š
- rule_set:
    match: https://raw.githubusercontent.com/Cats-Team/AdRules/refs/heads/main/adrules.list
    policy: çŒæ€å¹¿å‘Š
- domain_regex:
    match: ^ad\..*|^ads\..*|^advert\..*
    policy: çŒæ€å¹¿å‘Š

# 2. Apple åˆ†æµ
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppleProxy/AppleProxy.list
    policy: Apple
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/TestFlight/TestFlight.list
    policy: Apple

- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple.list
    policy: DIRECT
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Apple.yaml
    policy: DIRECT

# 3. å±€åŸŸç½‘ä¸å›½å†…ç›´è¿
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Lan.yaml
    policy: DIRECT
- domain_suffix:
    match: cn
    policy: DIRECT
- geoip:
    match: CN
    policy: DIRECT
    no_resolve: true
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/ChinaMax/ChinaMax_All.list
    policy: DIRECT

# 4. ç¬¬ä¸‰æ–¹æœåŠ¡åˆ†æµ
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/AIGC.yaml
    policy: AIGC
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Bing.yaml
    policy: ç¾å›½è‡ªåŠ¨ 
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Disney.yaml
    policy: Disney
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Github.yaml
    policy: GitHub
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Google.yaml
    policy: Google
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/HBO.yaml
    policy: HBO
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Microsoft.yaml
    policy: Microsoft
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Netflix.yaml
    policy: Netflix
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/PayPal.yaml
    policy: PayPal
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Spotify.yaml
    policy: Spotify
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Telegram.yaml
    policy: Telegram
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/TikTok.yaml
    policy: TikTok
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/Twitter.yaml
    policy: Twitter
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/WeChat.yaml
    policy: WeChat
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/YouTube.yaml
    policy: YouTube
- rule_set:
    match: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Rule/YouTubeMusic.yaml
    policy: YouTubeMusic

# 5. å…œåº•ç­–ç•¥
- rule_set:
    match: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Proxy/Proxy_All.list
    policy: è‡ªé€‰ç­–ç•¥
- default:
    policy: è‡ªé€‰ç­–ç•¥

mitm:
  ca_p12: egern.p12
  ca_passphrase: egern
  hostnames:
    includes:
    - '*.google.com'
    - '*.github.com'

modules:
- url: https://raw.githubusercontent.com/jnlaoshu/MySelf/main/Egern/Module/Panel.yaml
  enabled: true
- name: Sub-Store
  url: https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Egern.yaml
  enabled: true
- name: ScriptHub
  url: https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.surge.sgmodule
  enabled: true
- name: WeatherKit
  url: https://github.com/NSRingo/WeatherKit/releases/latest/download/iRingo.WeatherKit.sgmodule
  enabled: true
- name: Spotify
  url: https://raw.githubusercontent.com/app2smile/rules/master/module/spotify.module
  enabled: true
- name: YouTube Enhance
  url: https://raw.githubusercontent.com/Maasea/sgmodule/master/YouTube.Enhance.sgmodule
  enabled: true
- name: BiliBiliå»å¹¿å‘Š
  url: https://raw.githubusercontent.com/app2smile/rules/master/module/bilibili.sgmodule
  enabled: true
- url: https://raw.githubusercontent.com/jadkg/egern/refs/heads/main/ç™¾åº¦åœ°å›¾.module
  enabled: true
- url: https://raw.githubusercontent.com/Yu9191/Rewrite/refs/heads/main/KuGou.sgmodule
  enabled: true
- url: https://raw.githubusercontent.com/Yuheng0101/X/main/Scripts/Kuwo/kuwo.sgmodule
  enabled: true
- url: http://script.hub/file/_start_/https://raw.githubusercontent.com/WeiGiegie/666/main/ximalaya.js/_end_/ximalaya.sgmodule?type=qx-rewrite&target=surge-module&del=true&jqEnabled=true
  enabled: true 
- name: å¥¶æ€å¹¿å‘Šæ‹¦æˆª&å‡€åŒ–åˆé›†
  url: https://raw.githubusercontent.com/fmz200/wool_scripts/main/Surge/module/blockAds.module
  enabled: true
